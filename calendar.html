<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TimberNova — Calendar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
  <style>
    body { margin:0; background:#020617; color:#f9fafb; font-family:system-ui,sans-serif; }
    header, footer { padding:16px 24px; background:rgba(2,6,23,0.9); border-bottom:1px solid rgba(148,163,184,0.3); display:flex; justify-content:space-between; align-items:center; }
    footer { border-top:1px solid rgba(148,163,184,0.3); border-bottom:none; margin-top:auto; }
    nav a { color:#9ca3af; text-decoration:none; margin-left:12px; font-size:14px; padding:6px 10px; border-radius:999px; }
    nav a:hover { background:rgba(148,163,184,0.2); color:#e5e7eb; }

    main { padding:24px; max-width:1000px; margin:0 auto; }

    .calendar-grid {
      display:grid;
      grid-template-columns:repeat(7,1fr);
      gap:8px;
      margin-top:20px;
    }

    .day {
      background:rgba(15,23,42,0.9);
      border:1px solid rgba(148,163,184,0.3);
      border-radius:12px;
      padding:10px;
      min-height:110px;
      display:flex;
      flex-direction:column;
      font-size:13px;
    }

    .day-number { font-size:12px; color:#9ca3af; margin-bottom:6px; }

    .event {
      background:linear-gradient(120deg,#22c55e,#4ade80);
      color:#022c22;
      padding:4px 6px;
      border-radius:6px;
      font-size:12px;
      margin-bottom:4px;
      cursor:pointer;
    }
  </style>
</head>
<body>

<header>
  <div>TimberNova • Calendar</div>
  <nav>
    <a href="dashboard.html">Dashboard</a>
    <a href="contracts.html">Contracts</a>
    <a href="calendar.html">Calendar</a>
    <a href="trees.html">Trees</a>
    <a href="network.html">Network</a>
    <a href="stores.html">Stores</a>
    <a href="calls.html">Calls</a>
    <a href="#" id="logout">Logout</a>
  </nav>
</header>

<main>
  <h1>Calendar</h1>
  <div class="sub">Scheduled jobs, contract deadlines, and events.</div>

  <div id="calendar" class="calendar-grid"></div>
</main>

<footer>TimberNova • Calendar</footer>

<script>
  if (!localStorage.getItem("timberNovaUser")) window.location.href = "index.html";
  document.getElementById("logout").onclick = () => {
    localStorage.removeItem("timberNovaUser");
    window.location.href = "index.html";
  };

  const calendarEl = document.getElementById("calendar");

  const events = JSON.parse(localStorage.getItem("timberNovaCalendarEvents") || "[]");

  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth();

  const firstDay = new Date(year, month, 1).getDay();
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  // Fill blank days
  for (let i = 0; i < firstDay; i++) {
    const blank = document.createElement("div");
    blank.className = "day";
    calendarEl.appendChild(blank);
  }

  // Fill actual days
  for (let d = 1; d <= daysInMonth; d++) {
    const dateStr = `${year}-${String(month+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;

    const dayEl = document.createElement("div");
    dayEl.className = "day";

    const num = document.createElement("div");
    num.className = "day-number";
    num.textContent = d;
    dayEl.appendChild(num);

    const todaysEvents = events.filter(e => e.date === dateStr);

    todaysEvents.forEach(ev => {
      const evEl = document.createElement("div");
      evEl.className = "event";
      evEl.textContent = ev.title;
      evEl.onclick = () => {
        window.location.href = `contract-sign.html?id=${ev.contractId}&mode=view`;
      };
      dayEl.appendChild(evEl);
    });

    calendarEl.appendChild(dayEl);
  }
</script>

</body>
</html>
